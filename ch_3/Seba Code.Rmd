---
title: "Eco detective - Chapter 3"
author: "Seba Tapia"
date: "6/25/2018"
output: html_document
---
#Packages
```{r packages}
library(dplyr)
```
#PSEUDOCODE 3.1
##Step 1
```{r Pseudocode 3.1 Step 1}
p <- 0.2
N <- 50
```
##Step 2

```{r Pseudocode 3.1 Step 2}
Po <- (1-p)^N
```

##Step 3
```{r Pseudocode 3.1 Step 3}
probKN <- function (N=50,p=0.2,k){
  k <- seq(1,N,by=1)
  p.vec <- vector(length=length(k), "numeric")
  p.vec[1] <- Po
  for (i in k) {
  p.vec[i+1] = ((N-k[i])/k[i])*((p)/(1-p))*p.vec[i]
  p.vec <- p.vec[1:N]
  }
  plot(x=k, y=p.vec, type="l")
  
}
probKN()
```

##An Ecological Scenario: Sampling for pests
```{r Pseudocode Ecological Scenario: PESTS}
probKNPest <- function (N=10,p=0.1,k){
  k <- seq(1,N,by=1)
  p.vec <- vector(length=length(k), "numeric")
  p.vec[1] <- (1-p)^N
  for (i in k) {
  p.vec[i+1] = ((N-k[i])/k[i])*((p)/(1-p))*p.vec[i]
  p.vec <- p.vec[1:11]
  k <- k[1:11]
  }
  plot(x=k, y=p.vec, type="l")
}
probKNPest()
probKNPest(p=0.2)
probKNPest(p=0.3)
```

#Pseudocode 3.2
```{r Pseudocode 3.2}
r <- 0.05
t <- 50
cutoff <- 0.999
Pot <- (2.71828)^(-r*t)
Sum <- Pot

MultiNomDist <- function(r=0.05,t=50, kmax){
  k <- seq(1,kmax,by=1)
  p.vec <- vector(length=length(k), "numeric")
  p.vec[1] <- (2.71828)^(-r*t)
  for (i in k){
  p.vec[i+1] = ((r*t)/k[i+1])*(p.vec[i])
  Sum <- Sum + p.vec[i]
  if(Sum >= cutoff) {break}
  
  #k <- k[1:4]
  }
  p.vec <- p.vec[1:kmax]
  #plot(x=k, y=p.vec, type="l")
  return(Sum)
}
MultiNomDist(kmax=200)

#I couldn't set the conditions for the loop to start if Sum >= cutoff
```